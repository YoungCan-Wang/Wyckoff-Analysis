# A è‚¡å†å²è¡Œæƒ… CSV å¯¼å‡ºè„šæœ¬ï¼ˆakshareï¼‰

ç”¨ Python + [akshare](https://github.com/akfamily/akshare) æ‹‰å–æŒ‡å®š A è‚¡è¿‘ N ä¸ªäº¤æ˜“æ—¥çš„æ—¥çº¿æ•°æ®ï¼Œå¹¶ç”Ÿæˆä¸¤ä»½ CSVï¼š

- `{è‚¡ç¥¨ä»£ç }_{è‚¡ç¥¨å}_hist_data.csv`ï¼šakshare è¿”å›çš„åŸå§‹å­—æ®µ
- `{è‚¡ç¥¨ä»£ç }_{è‚¡ç¥¨å}_ohlcv.csv`ï¼šé¢å‘åˆ†æçš„å¢å¼º OHLCVï¼ˆå«æˆäº¤é¢/æ¢æ‰‹ç‡/æŒ¯å¹…/å‡ä»·/è¡Œä¸šï¼‰

ç¤ºä¾‹ï¼š

- `300364_ä¸­æ–‡åœ¨çº¿_hist_data.csv`
- `300364_ä¸­æ–‡åœ¨çº¿_ohlcv.csv`

---

## ç›®å½•ç»“æ„

```text
.
â”œâ”€â”€ fetch_a_share_csv.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

---

## ç¯å¢ƒé…ç½®

### 1) ä¾èµ–

- macOS / Linux / Windows å‡å¯
- Python 3.10+ï¼ˆå»ºè®®ç”¨ venvï¼›macOS Homebrew Python é»˜è®¤å¯ç”¨ PEP 668ï¼Œä¸èƒ½ç›´æ¥å…¨å±€ pip installï¼‰

### 2) åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–ï¼ˆæ¨èï¼‰

```bash
cd /path/to/akshare

python3 -m venv .venv
source .venv/bin/activate

python -m pip install -U pip
python -m pip install -r requirements.txt
```

éªŒè¯ akshare å¯ç”¨ï¼š

```bash
python -c "import akshare as ak; print(ak.__version__)"
```

---

## è¿è¡Œæ–¹å¼

è„šæœ¬ï¼š[fetch_a_share_csv.py](file:///Users/youngcan/akshare/fetch_a_share_csv.py)

### 1) å•åªè‚¡ç¥¨

```bash
source .venv/bin/activate
python fetch_a_share_csv.py --symbol 300364
```

### 2) å¤šåªè‚¡ç¥¨ï¼ˆç›´æ¥ç»™ä»£ç åˆ—è¡¨ï¼‰

```bash
source .venv/bin/activate
python -u fetch_a_share_csv.py --symbols 000973 600798 601390 600362 002186 300459 601698 603885
```

### 3) å¤šåªè‚¡ç¥¨ï¼ˆä»æ··åˆæ–‡æœ¬ä¸­æå– 6 ä½è‚¡ç¥¨ä»£ç ï¼‰

é€‚åˆâ€œä»£ç +ä¸­æ–‡åæ··åœ¨ä¸€èµ·/ç”šè‡³æ²¡ç©ºæ ¼â€çš„è¾“å…¥ï¼š

```bash
source .venv/bin/activate
python -u fetch_a_share_csv.py --symbols-text '000973 ä½›å¡‘ç§‘æŠ€ 600798é²æŠ—åŒ»è¯ 601390ä¸­å›½ä¸­è¯¶ 600362 æ±Ÿè¥¿é“œä¸š 002186 å…¨èšå¾· 300459 æ±¤å§†çŒ« 601698ä¸­å›½å«é€š603885 å‰ç¥¥èˆªç©º'
```

---

## äº¤æ˜“æ—¥/æ—¶é—´çª—å£è§„åˆ™ï¼ˆå…³é”®ï¼‰

æœ¬è„šæœ¬æŒ‰â€œäº¤æ˜“æ—¥â€è®¡ç®—æ—¶é—´çª—å£ï¼Œè‡ªåŠ¨è·³è¿‡å‘¨æœ«ä¸æ³•å®šèŠ‚å‡æ—¥ã€‚

- ç»“æŸæ—¥ï¼ˆendï¼‰ï¼š`ç³»ç»Ÿæ—¥æœŸ - 1 å¤©ï¼ˆè‡ªç„¶æ—¥ï¼‰`ï¼Œå†å¯¹é½åˆ° `<= end` çš„æœ€è¿‘äº¤æ˜“æ—¥
- å¼€å§‹æ—¥ï¼ˆstartï¼‰ï¼šä»ç»“æŸäº¤æ˜“æ—¥å‘å‰å›æº¯ `N` ä¸ªäº¤æ˜“æ—¥ï¼ˆé»˜è®¤ 50 ä¸ªäº¤æ˜“æ—¥ï¼ŒåŒ…å«ç»“æŸäº¤æ˜“æ—¥ï¼‰

å¯¹åº”å‚æ•°ï¼š

- `--trading-days`ï¼šäº¤æ˜“æ—¥æ•°é‡ï¼ˆé»˜è®¤ 500ï¼‰
- `--end-offset-days`ï¼šç»“æŸæ—¥çš„è‡ªç„¶æ—¥åç§»ï¼ˆé»˜è®¤ 1ï¼‰

ç¤ºä¾‹ï¼šç»“æŸæ—¥æ”¹ä¸ºâ€œç³»ç»Ÿæ—¥æœŸ-2å¤©â€

```bash
python fetch_a_share_csv.py --symbol 300364 --end-offset-days 2
```

å®ç°æ–¹å¼ï¼šä½¿ç”¨ `ak.tool_trade_date_hist_sina()` è·å– A è‚¡å†å²äº¤æ˜“æ—¥å†ï¼Œå†åœ¨è¯¥æ—¥å†é‡Œå®šä½ç»“æŸæ—¥å¹¶å›æº¯ N ä¸ªäº¤æ˜“æ—¥ã€‚

---

## CSV å­—æ®µè¯´æ˜

### 1) hist_data.csvï¼ˆåŸå§‹å­—æ®µï¼‰

ä»¥ akshare `stock_zh_a_hist` çš„è¿”å›ä¸ºå‡†ï¼Œå¸¸è§åˆ—åŒ…æ‹¬ï¼š

- `æ—¥æœŸ`
- `è‚¡ç¥¨ä»£ç `
- `å¼€ç›˜` / `æ”¶ç›˜` / `æœ€é«˜` / `æœ€ä½`
- `æˆäº¤é‡` / `æˆäº¤é¢`
- `æŒ¯å¹…` / `æ¶¨è·Œå¹…` / `æ¶¨è·Œé¢` / `æ¢æ‰‹ç‡`

### 2) ohlcv.csvï¼ˆæ ‡å‡† OHLCVï¼‰

å›ºå®šåˆ—ï¼ˆä¾¿äºå–‚ç»™ç­–ç•¥å›æµ‹/å¯è§†åŒ–å·¥å…·ï¼›åˆ—åä¸ºè‹±æ–‡å¤§é©¼å³°ï¼‰ï¼š

- `Date`ï¼šYYYY-MM-DD
- `Open, High, Low, Close`
- `Volume`ï¼šæˆäº¤é‡ï¼ˆè‚¡ï¼‰
- `Amount`ï¼šæˆäº¤é¢ï¼ˆé‡‘é¢ï¼Œæ•°æ®æºå£å¾„ï¼‰
- `TurnoverRate`ï¼šæ¢æ‰‹ç‡ï¼ˆæ•°å€¼ï¼Œéç™¾åˆ†å·å­—ç¬¦ä¸²ï¼‰
- `Amplitude`ï¼šæŒ¯å¹…ï¼ˆæ•°å€¼ï¼Œéç™¾åˆ†å·å­—ç¬¦ä¸²ï¼‰
- `AvgPrice`ï¼š`Amount / Volume`ï¼ˆVolume ä¸º 0 æ—¶ä¸ºç©ºï¼‰
- `Sector`ï¼šè¡Œä¸šï¼ˆæ¥è‡ª `stock_individual_info_em` çš„ `è¡Œä¸š` å­—æ®µï¼Œå–ä¸åˆ°åˆ™ä¸ºç©ºï¼‰

---

## å¤æƒè¯´æ˜ï¼ˆå‰å¤æƒ/åå¤æƒï¼‰

å‚æ•° `--adjust`ï¼š

- `""`ï¼šä¸å¤æƒï¼ˆé»˜è®¤ï¼‰
- `qfq`ï¼šå‰å¤æƒ
- `hfq`ï¼šåå¤æƒ

ç¤ºä¾‹ï¼š

```bash
python fetch_a_share_csv.py --symbol 300364 --adjust qfq
```

---

## è‚¡ç¥¨åŸºç¡€çŸ¥è¯†é€Ÿè§ˆï¼ˆå¤Ÿç”¨ç‰ˆï¼‰

### 1) A è‚¡ä»£ç ä¸äº¤æ˜“æ‰€

å›½å†…å¸¸è§æ˜¯ 6 ä½æ•°å­—ä»£ç ï¼Œæœ¬è„šæœ¬ç›´æ¥ä½¿ç”¨ 6 ä½æ•°å­—ï¼ˆä¸éœ€è¦ `sh`/`sz` å‰ç¼€ï¼‰ï¼Œä¾‹å¦‚ï¼š

- `600xxx / 601xxx / 603xxx`ï¼šå¤šæ•°ä¸ºä¸Šäº¤æ‰€ä¸»æ¿ï¼ˆä¹Ÿæœ‰ç§‘åˆ›æ¿ `688xxx`ï¼‰
- `000xxx / 002xxx`ï¼šå¤šæ•°ä¸ºæ·±äº¤æ‰€ä¸»æ¿/ä¸­å°æ¿
- `300xxx`ï¼šåˆ›ä¸šæ¿

### 2) äº¤æ˜“æ—¥æ˜¯ä»€ä¹ˆ

â€œäº¤æ˜“æ—¥â€ä¸æ˜¯è‡ªç„¶æ—¥ï¼š

- å‘¨å…­ã€å‘¨æ—¥ä¸äº¤æ˜“
- æ³•å®šèŠ‚å‡æ—¥/è°ƒä¼‘ç­‰ä¹Ÿå¯èƒ½ä¸äº¤æ˜“

æ‰€ä»¥â€œæœ€è¿‘ 500 ä¸ªäº¤æ˜“æ—¥â€å¿…é¡»å€ŸåŠ©äº¤æ˜“æ—¥å†è®¡ç®—ã€‚æœ¬è„šæœ¬å·²å†…ç½®è¯¥é€»è¾‘ã€‚

### 3) åç§°ä»¥æ•°æ®æºä¸ºå‡†

ä½ è¾“å…¥çš„â€œä»£ç +ä¸­æ–‡åâ€åªæ˜¯è¾…åŠ©é˜…è¯»ï¼Œè„šæœ¬ä¼šç”¨ `stock_info_a_code_name()` åæŸ¥çœŸå®åç§°å¹¶ç”¨äºæ–‡ä»¶åã€‚

---

## å¸¸è§é—®é¢˜

### 1) macOS ä¸Š pip æŠ¥ externally-managed-environmentï¼ˆPEP 668ï¼‰

ç”¨ venv å®‰è£…ä¾èµ–å³å¯ï¼ˆè§ä¸Šæ–¹â€œç¯å¢ƒé…ç½®â€ï¼‰ã€‚

### 2) è¾“å‡ºæ–‡ä»¶åé‡Œæœ‰ç©ºæ ¼ï¼ˆæ¯”å¦‚ `å…¨ èš å¾·`ï¼‰

è¿™æ˜¯æ•°æ®æºçš„è‚¡ç¥¨åç§°æœ¬èº«å¸¦ç©ºæ ¼ï¼›è„šæœ¬ä¼šæŒ‰åŸæ ·å†™å…¥æ–‡ä»¶åï¼ˆä»…æ›¿æ¢ä¸å…è®¸çš„æ–‡ä»¶åå­—ç¬¦ï¼‰ã€‚

### 3) ç½‘ç»œ/æ•°æ®æºä¸ç¨³å®š

akshare ä¾èµ–å…¬å¼€æ•°æ®æºï¼Œå¶å°”ä¼šæœ‰å¤±è´¥/é™æµ/å­—æ®µå˜åŠ¨ã€‚è„šæœ¬ä¼šé€åªè‚¡ç¥¨æ‰“å° `OK/FAIL`ï¼Œå¤±è´¥ä¸ä¼šå½±å“å…¶å®ƒè‚¡ç¥¨ç»§ç»­å¯¼å‡ºã€‚

---

## Web å¯è§†åŒ–å·¥å…· (Streamlit)

æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª Web ç•Œé¢ï¼Œå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æŸ¥è¯¢ã€é¢„è§ˆæ•°æ®å¹¶ä¸€é”®ä¸‹è½½ CSVã€‚

### 1) æœ¬åœ°è¿è¡Œ

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source .venv/bin/activate

# å¯åŠ¨ Streamlit
streamlit run streamlit_app.py
```

æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ `http://localhost:8501`ã€‚

### 2) å…¬ç½‘éƒ¨ç½² (Streamlit Community Cloud)

æ¨èä½¿ç”¨å®˜æ–¹å…è´¹çš„ Streamlit Community Cloud è¿›è¡Œä¸€é”®éƒ¨ç½²ï¼š

1. Fork æœ¬ä»“åº“åˆ°ä½ çš„ GitHubã€‚
2. è®¿é—® [share.streamlit.io](https://share.streamlit.io/) å¹¶ä½¿ç”¨ GitHub ç™»å½•ã€‚
3. ç‚¹å‡» "New app"ï¼Œé€‰æ‹©ä½ çš„ä»“åº“ã€åˆ†æ”¯ (main)ã€‚
4. ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ« `streamlit_app.py`ï¼Œç‚¹å‡» "Deploy"ï¼Œç­‰å¾…å‡ åˆ†é’Ÿå³å¯è®¿é—®ã€‚

[![Open in Streamlit](https://static.streamlit.io/badges/streamlit_badge_black_white.svg)](https://share.streamlit.io/)

### 3) åœ¨çº¿è®¿é—® (Demo)

ä½ å¯ä»¥ç›´æ¥è®¿é—®ä»¥ä¸‹é“¾æ¥ä½¿ç”¨æœ¬å·¥å…·ï¼ˆåŸºäº main åˆ†æ”¯çƒ­æ›´æ–°ï¼‰ï¼š

ğŸ‘‰ **[https://wyckoff-analysis-youngcanphoenix.streamlit.app/](https://wyckoff-analysis-youngcanphoenix.streamlit.app/)**
